<!-- each category page -->
{% if page.type %}
<div class="archive">
  <p class="archive_type">{{ page.type }}</p>
  <ul>
    {% for post in site.categories[page.type] %}
    {% if post.url %}
    <li>
        <time class='archive_date' datetime='{{ post.date | date_to_xmlschema }}'>
          {{ post.date | date: "%b %-d, %Y" }}
        </time>
        <div class='archive_title'>
          <a href='{{ post.url | relative_url }}'>
            {{ post.title | escape }}
          </a>
        </div>
      </li>
    {% endif %}
    {% endfor %}

  </ul>
</div>

<!-- main page -->
{% else %}
<div class="archive">
  {% assign sorted_news = site.data.recent_news | sort: 'date' | reverse %}
  {% assign current_year = "" %}
  {% for post in sorted_news %}
    {% capture post_year %}{{ post.date | date: '%Y' }}{% endcapture %}
    {% if post_year != current_year %}
      {% unless forloop.first %}
        </ul>
      {% endunless %}
      <p class="archive_year">{{ post_year }}</p>
      <ul>
      {% assign current_year = post_year %}
    {% endif %}
    <li>
      <time class='archive_date' datetime='{{ post.date | date_to_xmlschema }}'>
        {{ post.date | date: "%b %-d, %Y" }}
      </time>
      <div class='archive_title'>
        {{ post.title | escape }}
        {% if post.url and post.link_text %}
        <a href='{{ post.url }}'>{{ "(Link)" | escape }}</a>
        {% endif %}
      </div>
      {% if post.additional_info %}
      <p class='news_additional_info'>
        {{ post.additional_info | escape }}
      </p>
      {% endif %}
    </li>
  {% endfor %}
  </ul>
</div>
{% endif %}